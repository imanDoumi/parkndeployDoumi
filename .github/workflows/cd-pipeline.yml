name: CD Pipeline

# Ce workflow se déclenche quand le CI Release a fini sur main
on:
  workflow_run:
    workflows: ["CI Release"]
    types:
      - completed

jobs:
  deploy:
    name: Deploy Application
    runs-on: ubuntu-latest

    steps:
      # Récupérer le code
      - name: Checkout repository
        uses: actions/checkout@v4

      # Télécharger l'artifact Frontend
      - name: Download frontend artifact
        uses: actions/download-artifact@v3
        with:
          name: frontend-build
          path: ./frontend_dist

      # Télécharger l'artifact Backend
      - name: Download backend artifact
        uses: actions/download-artifact@v3
        with:
          name: backend-publish
          path: ./backend_publish

      # Optionnel : Afficher la structure des fichiers pour vérifier
      - name: List Frontend files
        run: ls -R ./frontend_dist

      - name: List Backend files
        run: ls -R ./backend_publish

      # Ici tu peux ajouter les étapes de déploiement réelles
      # Exemple : copier les fichiers sur un serveur, Azure, Docker, etc.
      - name: Deploy Frontend
        run: echo "Déploiement Frontend ici..."

      - name: Deploy Backend
        run: echo "Déploiement Backend ici..."
